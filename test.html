<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.8.0/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.8.0/ScrollTrigger.min.js"></script>
<script src="https://unpkg.com/splitting/dist/splitting.min.js"></script>

<script>
gsap.registerPlugin(ScrollTrigger);

ScrollTrigger.defaults({
  markers: false
});


$(".split-text").each(function (index) {
  let myText = $(this);
  let mySplitText;
  function createSplits() {
    mySplitText = new SplitText(myText, {
      type: "chars,words,lines",
      charsClass: "split-chars",
      wordsClass: "split-words",
      linesClass: "split-lines"
    });
  }
  createSplits();
  $(window).resize(function () {
  	if (window.outerWidth !== windowWidth) {
    	mySplitText.revert();
			location.reload();
    }
    windowWidth = window.outerWidth;
  });
});
  // Letter Animation
  $(".letter-animation").each(function (index) {
    let triggerElement = $(this);
    let myText = $(this).find(".split-text");
    let targetElement = $(this).find(".split-chars");

    let tl = gsap.timeline({
      scrollTrigger: {
        trigger: triggerElement,
        // trigger element - viewport
        start: "top bottom",
        end: "bottom top",
        toggleActions: "restart none none none"
      }
    });
    tl.from(targetElement, {
      duration: 0.5,
      y: "60%",
      opacity: 0,
      rotationX: -90,
      ease: "power1.inOut",
      stagger: {
        amount: 0.7,
        from: "0"
      }
    });
  });
}

// Logo Scale
$(".section.is--hero").each(function (index) {
  let triggerElement = $(this);
  let targetElement = $(".nav_logo");

  let tl = gsap.timeline({
    scrollTrigger: {
      trigger: triggerElement,
      // trigger element - viewport
      start: "top top",
      end: "bottom top",
      scrub: 1
    }
  });
  tl.from(targetElement, {
    y: "-90%",
    width: "50%",
    duration: 1
  });
});

// Header Text Hide
$(".header_text-move").each(function (index) {
  let triggerElement = $(this);
  let targetElement = $(this);

  let tl = gsap.timeline({
    scrollTrigger: {
      trigger: triggerElement,
      // trigger element - viewport
      start: "-100% top",
      end: "30% top",
      scrub: 0.8
    }
  });
  tl.to(targetElement, {
    y: "100%",
    duration: 1
  });
});

// Sticky Circle Grow
$(".sticky-circle_wrap").each(function (index) {
  let triggerElement = $(this);
  let targetElement = $(".sticky-circle_element");

  let tl = gsap.timeline({
    scrollTrigger: {
      trigger: triggerElement,
      // trigger element - viewport
      start: "top top",
      end: "bottom bottom",
      scrub: 1
    }
  });
  tl.fromTo(
    targetElement,
    {
      width: "35em",
      height: "35em",
      borderRadius: "35em",
      duration: 1
    },
    {
      width: "100vw",
      height: "100vh",
      borderRadius: "0em",
      duration: 1
    }
  );
});

// Light to Dark Color Change
$(".grid_wrapper:nth-child(odd)").each(function (index) {
  let triggerElement = $(this);
  let targetElement = $("body, .section.is--nav");

  let tl = gsap.timeline({
    scrollTrigger: {
      trigger: triggerElement,
      // trigger element - viewport
      // can also use "20px 80%"
      start: "top top",
      end: "bottom bottom",
      scrub: 1
    }
  });
  tl.fromTo(
    targetElement,
    {
      backgroundColor: "#111",
      color: "#2e2a27",
      duration: 1
    },
    {
      backgroundColor: "#111",
      color: "#e8e2da",
      duration: 1
    }
  );
});

// Dark to Light Color Change
$(".grid_wrapper:nth-child(even), .sticky-circle_wrap").each(function (index) {
  let triggerElement = $(this);
  let targetElement = $("body, .section.is--nav");

  let tl = gsap.timeline({
    scrollTrigger: {
      trigger: triggerElement,
      // trigger element - viewport
      // can also use "20px 80%"
      start: "top top",
      end: "bottom bottom",
      scrub: 1
    }
  });
  tl.fromTo(
    targetElement,
    {
      backgroundColor: "#111",
      color: "#e8e2da",
      duration: 1
    },
    {
      backgroundColor: "#e8e2da",
      color: "#2e2a27",
      duration: 1
    }
  );
});

// Grid Title Change
$(".grid_text-item").eq(0).addClass("is--active");
$(".grid_wrapper").each(function (index) {
  let triggerElement = $(this);
  let myIndex = $(this).index();
  let targetElement = $(".grid_text-item").eq(myIndex);
  let tl = gsap.timeline({
    scrollTrigger: {
      trigger: triggerElement,
      // trigger element - viewport
      start: "top bottom",
      end: "bottom bottom",
      onEnter: () => {
        $(".grid_text-item").removeClass("is--active");
        targetElement.addClass("is--active");
      },
      onEnterBack: () => {
        $(".grid_text-item").removeClass("is--active");
        targetElement.addClass("is--active");
      }
    }
  });
});

// Grid Image Move 1
$(".grid_item:nth-child(3n+1)").each(function (index) {
  let triggerElement = $(this);
  let targetElement = $(this);

  let tl = gsap.timeline({
    scrollTrigger: {
      trigger: triggerElement,
      // trigger element - viewport
      start: "top bottom",
      end: "bottom top",
      scrub: 1
    }
  });
  tl.to(targetElement, {
    y: "-30%",
    duration: 1
  });
});

// Grid Image Move 2
$(".grid_item:nth-child(3n+2)").each(function (index) {
  let triggerElement = $(this);
  let targetElement = $(this);

  let tl = gsap.timeline({
    scrollTrigger: {
      trigger: triggerElement,
      // trigger element - viewport
      start: "top bottom",
      end: "bottom top",
      scrub: 2
    }
  });
  tl.to(targetElement, {
    y: "-50%",
    duration: 1
  });
});

// Grid Image Move 3
$(".grid_item:nth-child(3n+3)").each(function (index) {
  let triggerElement = $(this);
  let targetElement = $(this);

  let tl = gsap.timeline({
    scrollTrigger: {
      trigger: triggerElement,
      // trigger element - viewport
      start: "top bottom",
      end: "bottom top",
      scrub: 1.5
    }
  });
  tl.to(targetElement, {
    y: "-70%",
    duration: 1
  });
});
</script>
